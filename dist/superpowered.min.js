class SuperpoweredGlue{static wasmCDNUrl="https://www.unpkg.com/@superpoweredsdk/web@2.6.4/dist/superpowered-npm.wasm";niceSize(e){var t;return 0==e?"0 byte":1==e?"1 byte":(t=parseInt(Math.floor(Math.log(e)/Math.log(1024))),Math.round(e/Math.pow(1024,t),2)+[" bytes"," kb"," mb"," gb"," tb"][t])}createFloatArray(e){return this.createViewFromType(9,this.malloc(4*e),e)}static async Instantiate(e,t=SuperpoweredGlue.wasmCDNUrl){SuperpoweredGlue.wasmCDNUrl=t;const r=new SuperpoweredGlue;return await fetch(t).then(e=>e.arrayBuffer()).then(e=>r.loadFromArrayBuffer(e)),r.Initialize(e),r}constructor(){this.id=Math.floor(Math.random()*Date.now()),this.linearMemory=null,this.__lastObject__=null,this.__classUnderConstruction__=null,this.__functions__={},this.__classes__={},this.__exportsToWasm__={},this.__views__=new Set,this.trackLoaderReceivers=[];const glue=this;this.Uint8Buffer=class{constructor(e){return glue.createViewFromType(1,glue.malloc(e),e)}},this.Int8Buffer=class{constructor(e){return glue.createViewFromType(2,glue.malloc(e),e)}},this.Uint16Buffer=class{constructor(e){return glue.createViewFromType(3,glue.malloc(2*e),e)}},this.Int16Buffer=class{constructor(e){return glue.createViewFromType(4,glue.malloc(2*e),e)}},this.Uint32Buffer=class{constructor(e){return glue.createViewFromType(5,glue.malloc(4*e),e)}},this.Int32Buffer=class{constructor(e){return glue.createViewFromType(6,glue.malloc(4*e),e)}},this.BigUint64Buffer=class{constructor(e){return glue.createViewFromType(7,glue.malloc(8*e),e)}},this.BigInt64Buffer=class{constructor(e){return glue.createViewFromType(8,glue.malloc(8*e),e)}},this.Float32Buffer=class{constructor(e){return glue.createViewFromType(9,glue.malloc(4*e),e)}},this.Float64Buffer=class{constructor(e){return glue.createViewFromType(10,glue.malloc(8*e),e)}},this.__exportsToWasm__.consolelog=this.consolelog.bind(this),this.__exportsToWasm__.emscripten_notify_memory_growth=this.onMemoryGrowth.bind(this),this.__exportsToWasm__.__createClass__=this.createClass.bind(this),this.__exportsToWasm__.__createStaticProperty__=this.createStaticProperty.bind(this),this.__exportsToWasm__.__createStaticMethod__=this.createStaticMethod.bind(this),this.__exportsToWasm__.__createConstructor__=this.createConstructor.bind(this),this.__exportsToWasm__.__createDestructor__=this.createDestructor.bind(this),this.__exportsToWasm__.__createProperty__=this.createProperty.bind(this),this.__exportsToWasm__.__createMethod__=this.createMethod.bind(this),this.__exportsToWasm__.__createFunction__=this.createFunction.bind(this),this.__exportsToWasm__.__createClassConstant__=this.createClassConstant.bind(this),this.__exportsToWasm__.__createConstant__=this.createConstant.bind(this),this.__exportsToWasm__.__runjs__=function(pointer){return eval(this.toString(pointer))}.bind(this),this.__exportsToWasm__.abs=function(e){return Math.abs(e)},this.__exportsToWasm__.round=function(e){return Math.round(e)},this.__exportsToWasm__.roundf=function(e){return Math.fround(e)},this.wasi={proc_exit:function(){console.log("abort")}}}updateBuffer(e,t){switch(e.__arraybuffer__=t,e.__type__){case 1:e.array=new Uint8Array(e.__arraybuffer__,e.pointer,e.length<0?e.__arraybuffer__.byteLength-e.pointer:e.length);break;case 2:e.array=new Int8Array(e.__arraybuffer__,e.pointer,e.length<0?e.__arraybuffer__.byteLength-e.pointer:e.length);break;case 3:e.array=new Uint16Array(e.__arraybuffer__,e.pointer,e.length<0?(e.__arraybuffer__.byteLength-e.pointer)/2:e.length);break;case 4:e.array=new Int16Array(e.__arraybuffer__,e.pointer,e.length<0?(e.__arraybuffer__.byteLength-e.pointer)/2:e.length);break;case 5:e.array=new Uint32Array(e.__arraybuffer__,e.pointer,e.length<0?(e.__arraybuffer__.byteLength-e.pointer)/4:e.length);break;case 6:e.array=new Int32Array(e.__arraybuffer__,e.pointer,e.length<0?(e.__arraybuffer__.byteLength-e.pointer)/4:e.length);break;case 7:e.array=new BigUint64Array(e.__arraybuffer__,e.pointer,e.length<0?(e.__arraybuffer__.byteLength-e.pointer)/8:e.length);break;case 8:e.array=new BigInt64Array(e.__arraybuffer__,e.pointer,e.length<0?(e.__arraybuffer__.byteLength-e.pointer)/8:e.length);break;case 9:e.array=new Float32Array(e.__arraybuffer__,e.pointer,e.length<0?(e.__arraybuffer__.byteLength-e.pointer)/4:e.length);break;case 10:e.array=new Float64Array(e.__arraybuffer__,e.pointer,e.length<0?(e.__arraybuffer__.byteLength-e.pointer)/8:e.length)}}createViewFromType(e,t,r){t={pointer:t,length:r,__arraybuffer__:this.linearMemory,__type__:e,__glue__:this,free(){this.__glue__.free(this.pointer),Object.getOwnPropertyNames(this).forEach(e=>delete this[e]),Object.setPrototypeOf(this,null)}};return this.updateBuffer(t,this.linearMemory),this.__views__.add(t),t}returnPointerToView(e,t){var r;return 0<t&&void 0!==e&&(r=this.__functions__.__lastarraylength__(),e=this.createViewFromType(t,e,0<r?r:-1)),e}invokeMethod(){if(2==arguments.length&&"object"==typeof arguments[1]){var t=arguments[1];let e=1;for(const s in t)arguments[e++]=t[s];arguments.length=e}var r=[];for(let e=arguments.length-1;0<e;e--)null!=arguments[e].array?arguments[e]=arguments[e].array.byteOffset:null!=arguments[e].__pointer__?arguments[e]=arguments[e].__pointer__:"string"==typeof arguments[e]&&(arguments[e]=this.__glue__.toWASMString(arguments[e]),r.push(arguments[e]));var e=arguments[0],o=(arguments[0]=this.__pointer__,e.function.apply(this,arguments));for(const a of r)this.__glue__.free(a);return o=this.__glue__.returnPointerToView(o,e.returnPointerType)}invokeFunction(){if(1==arguments.length&&"object"==typeof arguments[0]){var t=arguments[0];let e=0;for(const o in t)arguments[e++]=t[o];arguments.length=e}var r=[];for(let e=arguments.length-1;0<=e;e--)null!=arguments[e].array?arguments[e]=arguments[e].array.byteOffset:null!=arguments[e].__pointer__?arguments[e]=arguments[e].__pointer__:"string"==typeof arguments[e]&&(arguments[e]=this.glue.toWASMString(arguments[e]),r.push(arguments[e]));var e=this.apply(this,arguments);for(const s of r)this.glue.free(s);return this.glue.returnPointerToView(e,this.returnPointerType)}invokeExportedFunction(){let e=this.apply(this,arguments);return e=void 0!==e.array?e.array.byteOffset:e}createClass(e,t,r){const s=this,o=s.toString(e,t);s.__classUnderConstruction__=s.__classes__[o]=s[o]=class{constructor(){var e=Object.getPrototypeOf(this).constructor.__meta__;if(!e.hasConstructor)throw e.name+" has no constructor";this.__class__=e.name,this.__prev__=s.__lastObject__,null!=s.__lastObject__&&(s.__lastObject__.__next__=this),this.__next__=null,(this.__glue__=s).__lastObject__=this;var t=[].slice.call(arguments);t.unshift(s.malloc(e.size)),this.__pointer__=s[e.name+"::"+e.name].apply(null,t);for(const r of e.properties)s.createPropertyFromDescriptor(this,r);for(const o of e.methods)this[o.name]=s.invokeMethod.bind(this,{function:s[o.wasmFunction],returnPointerType:o.returnPointerType})}destruct(){var e=Object.getPrototypeOf(this).constructor.__meta__;e.hasDestructor&&s[e.name+"::~"+e.name](this.__pointer__),s.free(this.__pointer__),null!=this.__prev__&&(this.__prev__.__next__=this.__next__),null!=this.__next__&&(this.__next__.__prev__=this.__prev__),Object.getOwnPropertyNames(this).forEach(e=>delete this[e]),Object.setPrototypeOf(this,null)}},s.__classUnderConstruction__.__meta__={name:o,size:r,hasConstructor:!1,hasDestructor:!1,properties:[],methods:[],staticProperties:[]},delete s.__functionsWithNamespace__[o]}createConstructor(){this.__classUnderConstruction__.__meta__.hasConstructor=!0}createDestructor(){this.__classUnderConstruction__.__meta__.hasDestructor=this.__classUnderConstruction__.__meta__.hasConstructor}createClassConstant(e,t,r){this.__classUnderConstruction__[this.toString(e,t)]=r}createConstant(e,t,r){this[this.toString(e,t)]=r}createPropertyFromDescriptor(e,t){const r=this.createViewFromType(t.viewType,e.__pointer__+t.offset,t.viewLength);1<t.viewLength?Object.defineProperty(e,t.name,{get:function(){return r.array},set:function(e){r.array[index]=e},configurable:!0,enumerable:!0}):Object.defineProperty(e,t.name,{get:function(){return r.array[0]},set:function(e){r.array[0]=e},configurable:!0,enumerable:!0})}createProperty(e,t,r,o,s){this.__classUnderConstruction__.__meta__.properties.push({name:this.toString(e,t),offset:r,viewType:o,viewLength:s})}createStaticPropertyFromDescriptor(e,t){const r=this.createViewFromType(t.viewType,t.pointer,t.viewLength);1<t.viewLength?Object.defineProperty(e,t.name,{get:function(){return r.array},set:function(e){r.array[index]=e},configurable:!0,enumerable:!0}):Object.defineProperty(e,t.name,{get:function(){return r.array[0]},set:function(e){r.array[0]=e},configurable:!0,enumerable:!0})}createStaticProperty(e,t,r,o,s){e={name:this.toString(e,t),pointer:r,viewType:o,viewLength:s};this.__classUnderConstruction__.__meta__.staticProperties.push(e),this.createStaticPropertyFromDescriptor(this.__classUnderConstruction__,e)}createMethod(e,t,r){e=this.toString(e,t);this.__classUnderConstruction__.__meta__.methods.push({name:e,wasmFunction:this.__classUnderConstruction__.__meta__.name+"::"+e,returnPointerType:r})}createStaticMethod(e,t,r){e=this.toString(e,t),t=this.__classUnderConstruction__.__meta__.name+"::"+e;this[t].returnPointerType=r,(this[t].glue=this).__classUnderConstruction__[e]=this.invokeFunction.bind(this[t])}createFunction(e,t,r){var o=this.toString(e,t);if(!this[o]){for(const s in this.__functionsWithNamespace__)if(this.__functionsWithNamespace__[s][o]){this[o]=this.__functionsWithNamespace__[s][o],delete this.__functionsWithNamespace__[s][o];break}if(!this[o])return}this[o].returnPointerType=r,(this[o].glue=this)[o]=this.invokeFunction.bind(this[o])}exportToWasm(e,t){this.__exportsToWasm__[e]=this.invokeExportedFunction.bind(t)}onMemoryGrowth(e){this.linearMemory=this.wasmInstance.exports.memory.buffer,this.__memorygrowview__.buffer.byteLength<1&&this.updateMemoryViews(),this.logMemory()}consolelog(e,t){console.log(this.toString(e,t))}setInstance(e){this.wasmInstance=e,this.wasmInstance.exports._initialize(),this.__functions__=this.wasmInstance.exports,this.linearMemory=this.wasmInstance.exports.memory.buffer,this.__memorygrowpointer__=this.__functions__.__malloc__(16),this.__memorygrowview__=new Uint8Array(this.linearMemory,this.__memorygrowpointer__,16),this.__functionsWithNamespace__={};var t=this.__functions__.__malloc__(1024),r=new Uint8Array(this.linearMemory,this.__functions__.__malloc__(1024),1024);for(const s in this.__functions__)if("__demangle__"!=s){var o=this.__functions__.__demangle__(this.toWASMString(s,r),t);if(0<o){let e=this.toString(t,o);o=e.indexOf("("),o=(e=0<o?e.substring(0,o):e).lastIndexOf("::"),o=(e=0<o&&0<(o=e.lastIndexOf("::",o-1))?e.substr(o+2):e).split("::",2);2==o.length&&(this.__functionsWithNamespace__[o[0]]||(this.__functionsWithNamespace__[o[0]]={}),this.__functionsWithNamespace__[o[0]][o[1]]=this.__functions__[s]),this[e]=this.__functions__[s]}else this[s]=this.__functions__[s]}this.free(t),this.free(r.byteOffset),this.__functions__.__initialize__(),delete this.__functionsWithNamespace__,this.logMemory(),this.__classUnderConstruction__=null}async loadFromArrayBuffer(e,t=null){this.wasmCode=e,await WebAssembly.instantiate(e,{wasi_snapshot_preview1:this.wasi,env:this.__exportsToWasm__}).then(e=>{this.setInstance(e.instance),null!=t&&t.afterWASMLoaded()})}async loadFromModule(e){await WebAssembly.instantiate(e,{wasi_snapshot_preview1:this.wasi,env:this.__exportsToWasm__}).then(e=>{this.setInstance(e)})}async loadFromURL(e,t=!0){var r;WebAssembly.instantiateStreaming?(await WebAssembly.instantiateStreaming(fetch(e),{wasi_snapshot_preview1:this.wasi,env:this.__exportsToWasm__}).then(e=>{this.setInstance(e.instance)}),t&&(r=await fetch(e),this.wasmCode=await r.arrayBuffer())):(r=await(await fetch(e)).arrayBuffer(),t&&(this.wasmCode=r),await WebAssembly.instantiate(r,{wasi_snapshot_preview1:this.wasi,env:this.__exportsToWasm__}).then(e=>{this.setInstance(e.instance)}))}toString(e,t=0){let r=null;if(t<1){var o=Math.min(16384,this.linearMemory.byteLength-e);for(r=new Uint8Array(this.linearMemory,e,o),t=0;t<o&&0!=r[t];t++);}else r=new Uint8Array(this.linearMemory,e,t);let s="",a=0,n,i;for(;a<t;){var _=r[a];if(n=i=0,_<=127?(n=0,i=255&_):_<=223?(n=1,i=31&_):_<=239?(n=2,i=15&_):_<=244&&(n=3,i=7&_),0<t-a-n)for(let e=0;e<n;e++)i=i<<6|63&r[a+e+1];else i=65533,n=t-a;s+=String.fromCodePoint(i),a+=n+1}return s}toWASMString(e,t=null){var r,o=e.length,s=4*o+1;let a=0,n,i,_=0;for(null==t&&(r=this.malloc(s),t=new Uint8Array(this.linearMemory,r,s));a<o;){var u=e.codePointAt(a);for(n=i=0,u<=127?(n=0,i=0):u<=2047?(n=6,i=192):u<=65535?(n=12,i=224):u<=2097151&&(n=18,i=240),t[_++]=i|u>>n,n-=6;0<=n;)t[_++]=128|u>>n&63,n-=6;a+=65536<=u?2:1}return t[_]=0,t.byteOffset}logMemory(){console.log("WASM memory "+this.id+": "+this.niceSize(this.__functions__.__stacksize__())+" stack, "+this.niceSize(this.linearMemory.byteLength-this.__functions__.__heapbase__())+" heap, "+this.niceSize(this.linearMemory.byteLength)+" total.")}malloc(e){e=this.__functions__.__malloc__(e);return this.__memorygrowview__.buffer.byteLength<1&&this.updateMemoryViews(),e}updateMemoryViews(){for(const e of this.__views__)this.updateBuffer(e,this.linearMemory);this.__memorygrowview__=new Uint8Array(this.linearMemory,this.__memorygrowpointer__,16)}free(e){this.__functions__.__free__(e)}setInt64(e,t,r){this.__functions__.__setint64__(e,t,r)}bufferToWASM(e,t,r){let o=null,s=null;void 0===r&&(r=0),s="function"==typeof t.getChannelData?(o=t.getChannelData(0),t.getChannelData(1)):(o=t[r][0],t[r][1]);var a=(e.constructor===Array?e[r]:e).array,n=a.length;for(let e=0,t=0;e<n;e++,t++)a[e++]=o[t],a[e]=s[t]}bufferToJS(e,t,r){let o=null,s=null;void 0===r&&(r=0),s="function"==typeof t.getChannelData?(o=t.getChannelData(0),t.getChannelData(1)):(o=t[r][0],t[r][1]);var a=(e.constructor===Array?e[r]:e).array,n=a.length;for(let e=0,t=0;e<n;e++,t++)o[t]=a[e++],s[t]=a[e]}arrayBufferToWASM(e,t=0){var r=this.malloc(e.byteLength+t);return new Uint8Array(this.linearMemory).set(new Uint8Array(e,0,e.byteLength),r+t),r}copyWASMToArrayBuffer(e,t){var r=new ArrayBuffer(t);return new Uint8Array(r,0,t).set(new Uint8Array(this.linearMemory,e,t)),r}moveWASMToArrayBuffer(e,t){t=this.copyWASMToArrayBuffer(e,t);return this.free(e),t}static async loaderWorkerMain(r){SuperpoweredGlue.__uint_max__sp__=255;const o=await SuperpoweredGlue.Instantiate("");await fetch(r).then(e=>e.arrayBuffer()).then(e=>{var t=o.arrayBufferToWASM(e),t=o.Decoder.decodeToAudioInMemory(t,e.byteLength),e=o.moveWASMToArrayBuffer(t,48+4*o.AudioInMemory.getSize(t));void 0!==self.transfer?self.transfer(r,e):postMessage({__transfer__:e},[e])})}static loaderWorkerOnmessage(e){"string"==typeof e.data.load&&SuperpoweredGlue.loaderWorkerMain(e.data.load)}registerTrackLoader(e){return void 0!==e.terminate&&e.addEventListener("message",this.handleTrackLoaderMessage),this.trackLoaderReceivers.push(void 0!==e.port?e.port:e)-1}handleTrackLoaderMessage(e){return"string"==typeof e.data.SuperpoweredLoad&&(this.loadTrackInWorker(e.data.SuperpoweredLoad,e.data.trackLoaderID),!0)}async loadTrackInWorker(e,t){var r=SuperpoweredGlue.toString();const o=new Worker(URL.createObjectURL(new Blob([r+"\r\n\r\nonmessage = SuperpoweredGlue.loaderWorkerOnmessage;"+`\r
\r
SuperpoweredGlue.wasmCDNUrl = "${SuperpoweredGlue.wasmCDNUrl}";`],{type:"application/javascript"})));o.__url__=e,o.trackLoaderID=t,o.ontransfer=function(e){this.transferLoadedTrack(e.transfer,o)}.bind(this),o.onmessage=function(e){this.transferLoadedTrack(e.data.__transfer__,o)}.bind(this),"undefined"!=typeof window&&void 0!==window.location&&void 0!==window.location.origin&&(e=new URL(e,window.location.origin).toString()),o.postMessage({load:e})}transferLoadedTrack(e,t){var r=this.trackLoaderReceivers[t.trackLoaderID];null!=r&&("function"==typeof r.postMessage?r.postMessage({SuperpoweredLoaded:{buffer:e,url:t.__url__}},[e]):r({SuperpoweredLoaded:{buffer:e,url:t.__url__}}),t.terminate())}downloadAndDecode(e,t){void 0!==t.trackLoaderID&&("function"==typeof t.onMessageFromMainScope&&"function"==typeof t.sendMessageToMainScope?t.sendMessageToMainScope({SuperpoweredLoad:e,trackLoaderID:t.trackLoaderID}):this.loadTrackInWorker(e,t.trackLoaderID))}}class SuperpoweredWebAudio{static AudioWorkletHasBrokenModuleImplementation=!1;constructor(e,t){this.Superpowered=t,this.audioContext=null;t=window.AudioContext||window.webkitAudioContext||!1;let r=new t;r.sampleRate<e&&(r.close(),r=new t({sampleRate:e})),this.audioContext=r}getUserMediaForAudio(e,r,o){var s={};if(navigator.mediaDevices){var t=navigator.mediaDevices.getSupportedConstraints();for(const a in t)t.hasOwnProperty(a)&&void 0!==e[a]&&(s[a]=e[a])}if(s.audio=!0,s.video=!1,navigator.fastAndTransparentAudio=e.hasOwnProperty("fastAndTransparentAudio")&&!0===e.fastAndTransparentAudio,navigator.fastAndTransparentAudio&&(s.echoCancellation=!1,s.disableLocalEcho=!1,s.autoGainControl=!1,s.audio={mandatory:{googAutoGainControl:!1,googAutoGainControl2:!1,googEchoCancellation:!1,googNoiseSuppression:!1,googHighpassFilter:!1,googEchoCancellation2:!1,googNoiseSuppression2:!1,googDAEchoCancellation:!1,googNoiseReduction:!1}}),navigator.getUserMediaMethod=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mediaDevices.mozGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.getUserMediaMethod)navigator.getUserMediaMethod(s,r,o);else{let t=null;try{t=navigator.mediaDevices.getUserMedia}catch(e){"https"!=location.protocol.toLowerCase()&&"localhost"!=location.hostname.toLowerCase()?o("Web Audio requires a secure context (HTTPS or localhost)."):o(e),t=null}null!=t&&(t?navigator.mediaDevices.getUserMedia(s).then(r).catch(o):o("Can't access getUserMedia."))}}async getUserMediaForAudioAsync(t){return new Promise((r,e)=>{this.getUserMediaForAudio(t,function(e){if(navigator.fastAndTransparentAudio)for(const t of e.getAudioTracks())t.applyConstraints({autoGainControl:!1,echoCancellation:!1,noiseSuppression:!1});r(e)},e)})}async createAudioNodeAsync(r,o,s,a,n){return void 0===a&&(a=1),void 0===n&&(n=1),new Promise((e,t)=>this.createAudioNode(r,o,e,s,a,n))}createAudioNode(e,t,o,s,a,n){SuperpoweredWebAudio.AudioWorkletHasBrokenModuleImplementation||"function"!=typeof AudioWorkletNode?import(e).then(e=>{const r=this.audioContext.createScriptProcessor(1024,2,2);r.trackLoaderID=this.Superpowered.registerTrackLoader(r),r.samplerate=this.audioContext.sampleRate,r.inputBuffer=this.Superpowered.createFloatArray(2048),r.outputBuffer=this.Superpowered.createFloatArray(2048),r.processor=new e.default(this.Superpowered,s,r.samplerate),r.sendMessageToAudioScope=function(e,t=0){r.processor.onMessageFromMainScope(e)},r.destruct=function(){r.processor.Superpowered.trackLoaderReceivers[r.trackLoaderID]=null,r.processor.state=-1,r.processor.onDestruct()},r.onaudioprocess=function(e){r.processor.Superpowered.bufferToWASM(r.inputBuffer,e.inputBuffer),0<r.processor.state&&r.processor.processAudio(r.inputBuffer,r.outputBuffer,r.inputBuffer.array.length/2),r.processor.Superpowered.bufferToJS(r.outputBuffer,e.outputBuffer)},r.processor.state=1,o(r)}):(void 0===a&&(a=1),void 0===n&&(n=1),this.audioContext.audioWorklet.addModule(e).then(()=>{const r=new AudioWorkletNode(this.audioContext,t,{processorOptions:{wasmCode:this.Superpowered.wasmCode,samplerate:this.audioContext.sampleRate,maxChannels:this.Superpowered.__maxChannels__,numberOfInputs:a,numberOfOutputs:n,trackLoaderID:this.Superpowered.trackLoaderReceivers.length},numberOfInputs:a,numberOfOutputs:n,outputChannelCount:Array(n).fill(2)});r.superpoweredWASMUrl=SuperpoweredGlue.wasmCDNUrl,r.trackLoaderID=this.Superpowered.registerTrackLoader(r),r.Superpowered=this.Superpowered,r.onReadyCallback=o,r.onMessageFromAudioScope=s,r.destruct=function(){r.Superpowered.trackLoaderReceivers[r.trackLoaderID]=null,r.port.postMessage("___superpowered___destruct___")},r.sendMessageToAudioScope=function(e,t=[]){r.port.postMessage(e,t)},r.port.onmessage=function(e){r.Superpowered.handleTrackLoaderMessage(e)||("___superpowered___onready___"==e.data?(r.state=1,r.onReadyCallback(r)):r.onMessageFromAudioScope(e.data))}.bind(r)}))}}if(SuperpoweredWebAudio.AudioWorkletHasBrokenModuleImplementation||"function"!=typeof AudioWorkletProcessor){class SuperpoweredAudioWorkletProcessor{constructor(e,t,r){this.Superpowered=e,this.samplerate=r,this.onMessageFromAudioScope=t,this.state=0,this.onReady()}onMessageFromAudioScope=null;onReady(){}onDestruct(){}onMessageFromMainScope(e){}sendMessageToMainScope(e){this.Superpowered.handleTrackLoaderMessage({data:e})||this.onMessageFromAudioScope(e)}postMessage(e,t=0){this.onMessageFromMainScope(e)}processAudio(e,t){}}SuperpoweredWebAudio.AudioWorkletProcessor=SuperpoweredAudioWorkletProcessor}else{class SuperpoweredAudioWorkletProcessor extends AudioWorkletProcessor{constructor(e){super(),SuperpoweredGlue.__uint_max__sp__=e.processorOptions.maxChannels,this.trackLoaderID=e.processorOptions.trackLoaderID,this.state=0,this.port.onmessage=e=>{"___superpowered___destruct___"==e.data?(this.state=-1,this.onDestruct()):this.onMessageFromMainScope(e.data)},this.samplerate=e.processorOptions.samplerate,this.Superpowered=new SuperpoweredGlue,this.Superpowered.loadFromArrayBuffer(e.processorOptions.wasmCode,this),this.numberOfInputs=e.processorOptions.numberOfInputs,this.numberOfOutputs=e.processorOptions.numberOfOutputs}afterWASMLoaded(){this.superpoweredWASMUrl&&(SuperpoweredGlue.wasmCDNUrl=this.superpoweredWASMUrl),this.Superpowered.Initialize(),this.inputBuffers=[];for(let e=this.numberOfInputs;0<e;e--)this.inputBuffers.push(this.Superpowered.createFloatArray(256));this.outputBuffers=[];for(let e=this.numberOfOutputs;0<e;e--)this.outputBuffers.push(this.Superpowered.createFloatArray(256));this.onReady(),this.port.postMessage("___superpowered___onready___"),this.state=1}onReady(){}onDestruct(){}onMessageFromMainScope(e){}sendMessageToMainScope(e){this.port.postMessage(e)}processAudio(e,t){}process(t,r,e){if(this.state<0)return!1;if(1==this.state){for(let e=this.numberOfInputs-1;0<=e;e--)1<t[e].length?this.Superpowered.bufferToWASM(this.inputBuffers,t,e):this.Superpowered.memorySet(this.inputBuffers[e].pointer,0,1024);this.processAudio(1==this.numberOfInputs?this.inputBuffers[0]:this.inputBuffers,1==this.numberOfOutputs?this.outputBuffers[0]:this.outputBuffers,128,e);for(let e=this.numberOfOutputs-1;0<=e;e--)1<r[e].length&&this.Superpowered.bufferToJS(this.outputBuffers,r,e)}return!0}}SuperpoweredWebAudio.AudioWorkletProcessor=SuperpoweredAudioWorkletProcessor}"object"==typeof exports&&"object"==typeof module?module.exports={SuperpoweredGlue:SuperpoweredGlue,SuperpoweredWebAudio:SuperpoweredWebAudio}:"object"==typeof exports&&(exports.SuperpoweredGlue=SuperpoweredGlue,exports.SuperpoweredWebAudio=SuperpoweredWebAudio),"undefined"!=typeof globalThis&&(globalThis.SuperpoweredGlue=SuperpoweredGlue,globalThis.SuperpoweredWebAudio=SuperpoweredWebAudio);
